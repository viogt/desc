<!doctype html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>Upload an Excel File</title>
        <style>
            .container {
                max-width: 600px;
                margin: auto;
                padding: 24px;
                background-color: #eee;
                border: 0.8px solid #ccc;
                border-radius: 16px;
                font:
                    normal 18px/1.4 Arial,
                    sans-serif;
                text-align: center;
            }
            h2 {
                font:
                    bold 32px Arial,
                    sans-serif;
                color: #aab;
            }
        </style>
    </head>
    <body>
        <div class="container">
            <h2>Upload and Analyze</h2>
            <input type="file" id="fileInput" onchange="uploadFile()" />
            <p id="message"></p>
        </div>

        <script>
            async function uploadFile() {
                const fileInput = document.getElementById("fileInput");
                const file = fileInput.files[0]; // Get the first selected file
                const messageElement = document.getElementById("message");

                if (!file || !file.name.endsWith(".xlsx")) {
                    messageElement.innerHTML =
                        "<font color='red'>Please select an .XLSX file.</font>";
                    return;
                }
                messageElement.textContent = "Processing...";

                const formData = new FormData();
                formData.append("myFile", file);

                try {
                    const response = await fetch("/upload", {
                        method: "POST",
                        body: formData,
                    });

                    if (response.ok)
                        messageElement.innerHTML = await response.text();
                    else {
                        const errorText = await response.text();
                        messageElement.textContent = "Upload failed:"+ response.status + " - " + errorText;
                    }
                } catch (error) {
                    messageElement.textContent = `Network error: ${error.message}`;
                    console.error("Fetch error:", error);
                }
            }
        </script>
    </body>
</html>
